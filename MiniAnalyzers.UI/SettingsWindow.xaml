<Window x:Class="MiniAnalyzers.UI.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings"
        Height="600"
        Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource Brush.Background}"
        Foreground="{DynamicResource Brush.Foreground}" HorizontalAlignment="Center">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="DarkTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid Margin="12" Background="{DynamicResource Brush.Background}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Severity -->
            <RowDefinition Height="12"/>
            <RowDefinition Height="Auto"/>
            <!-- Include IDs -->
            <RowDefinition Height="12"/>
            <RowDefinition Height="Auto"/>
            <!-- Exclude IDs -->
            <RowDefinition Height="12"/>
            <RowDefinition Height="Auto"/>
            <!-- Search -->
            <RowDefinition Height="12"/>
            <RowDefinition Height="*"/>
            <!-- Known rules -->
            <RowDefinition Height="Auto"/>
            <!-- Buttons -->
        </Grid.RowDefinitions>

        <!-- Severity -->

        <GroupBox Header="Severity" Grid.Row="0" BorderBrush="{StaticResource Brush.Border}">
            <StackPanel Orientation="Horizontal" Margin="8" >
                <CheckBox Content="Info"    IsChecked="{Binding ShowInfo}"  Foreground="{StaticResource Brush.Foreground}" />
                <CheckBox Content="Warning" IsChecked="{Binding ShowWarning}" Margin="16,0,0,0"  Foreground="{StaticResource Brush.Foreground}" />
                <CheckBox Content="Error"   IsChecked="{Binding ShowError}"   Margin="16,0,0,0"  Foreground="{StaticResource Brush.Foreground}" />
            </StackPanel>
        </GroupBox>

        <!-- Include IDs -->
        <StackPanel Grid.Row="2">
            <TextBlock Text="Only include these IDs (CSV):" Margin="0,0,0,4"/>
            <TextBox Text="{Binding IncludeIdsCsv, UpdateSourceTrigger=PropertyChanged}" Height="26"/>
        </StackPanel>

        <!-- Exclude IDs -->
        <StackPanel Grid.Row="4">
            <TextBlock Text="Exclude these IDs (CSV):" Margin="0,0,0,4"/>
            <TextBox Text="{Binding ExcludeIdsCsv, UpdateSourceTrigger=PropertyChanged}" Height="26"/>
        </StackPanel>

        <!-- Search -->
        <StackPanel Grid.Row="6">
            <TextBlock Text="Search in message, analyzer, file path, or project:" Margin="0,0,0,4"/>
            <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" Height="26"/>
        </StackPanel>

        <!-- Known rules -->
        <GroupBox Header="Known rules" Grid.Row="8">
            <ListView x:Name="lstRules" Margin="6" Background="{DynamicResource Brush.Panel}">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Id">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding id}" 
                                       Foreground="White" 
                                       FontWeight="Bold"/>      
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Title" Width="240" DisplayMemberBinding="{Binding Title}" />
                        <GridViewColumn Header="Actions" Width="Auto">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" >
                                        <Button Content="Include" Margin="0,0,6,0"
                                                CommandParameter="{Binding id}"
                                                Click="AddInclude_Click" 
                                                Style="{StaticResource ToolbarButton}"/>
                                        <Button Content="Exclude"  Margin="0,0,6,0"
                                                CommandParameter="{Binding id}"
                                                Click="AddExclude_Click"
                                                Style="{StaticResource ToolbarButton}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>
        </GroupBox>

        <!-- Buttons -->
        <StackPanel Grid.Row="9" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="OK" Width="80" Margin="0,0,8,0" IsDefault="True" Click="Ok_Click" Style="{StaticResource PrimaryButton}"/>
            <Button Content="Cancel" Width="80"  Margin="0,0,8,0" IsCancel="True" Style="{StaticResource PrimaryButton}" VerticalAlignment="Stretch"/>
        </StackPanel>
    </Grid>
</Window>
